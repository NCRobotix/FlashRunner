<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flash Runner Game</title>
    <link rel="stylesheet" href="index.CSS">

  </head>
  <body>
    <div><img id="redplayer" src="Media/Players/RedPlayer.jpg" width="30" height="30"></div>
    <div id="red" width="20" height="20"></div>
    <div id="settings" class="setting-button"><img src="Media/Players/YellowPlayer.jpg" width="30" height="30"></div>
    <canvas id="gameCanvas" width="800" height="911"></canvas>
    <script>
        var p1x = 400;
        var p1y = 850;
        var pWidth = 30;
        var pHeight = 90;
        var width = 200;
        var height = 200;

        let screenSelect;

        
        //counters
        var score = 0;
        var lives = 1;
        var timer = 0;
        var timeLimit = 60;
        var splashTime;
        var gameTime = 0;
        
        //multimedia
        var red = new Image(30, 30);
        red.src = 'Media/Players/RedPlayer.jpg';
        var yellow = new Image(30, 30);
        yellow.src = 'Media/Players/YellowPlayer.jpg';

        var gameTheme = new Audio('Media/Sound/BlueScorpion.wav');
        var crashSound = new Audio('Media/Sound/sound.wav');
      window.onload = function draw() {
        var stage = 0;
        var canvas = document.getElementById("gameCanvas");
        var ca = canvas.getContext("2d");
        console.log(ca);
        splash();
        window.addEventListener('keydown', (e) => {
          if (e.code === "Space" & stage === 0) {
              stage = 1;
              screenSelect();
          }
        });
        if(stage === 0){
            splash();
          }
          if(stage === 1){
            game();
          }
          if(stage === 2){
            loseScreen();
          }
        function screenSelect(){
          keyPressed();
          if(stage === 0){
            splash();
          }
          if(stage === 1){
            return game();
          }
          if(stage === 2){
            loseScreen();
          }
        }
        
        function splash(){
            ca.font = "50px Arial";
            ca.fillText("FLASH RUNNER", 80, 150);
            ca.font = "40px Arial";
            ca.fillText("BY NC", 80, 200);
  
            ca.font = "20px Arial";
            ca.fillText("DIRECTIONS", 80, 250);
            ca.fillText("DODGE THE OBSTACLES BY MOVING WITH THE RIGHT AND LEFT KEYS", width/2, 300);
            ca.fillText("BY NC", 80, 350);
        }

        function game(){
          //gameTheme.play();
          ca.clearRect(0, 0, canvas.width, canvas.height);
          keyPressed();
          ca.drawImage(red, p1x, p1y, 30, 30);
        }
        
        function loseScreen(){
          crashSound.play();
          //image(landscape, 80, height/2, width, height);
          ca.clearRect(0, 0, canvas.width, canvas.height);
          ca.font = "50px Arial";
          ca.fillText("You died...", 240, 300);
          ca.font = "20px Arial";
          ca.fillText("SCORE: " + score, 320, 350);
          ca.font = "20px Arial";
          ca.fillText("Press SPACE to restart", 240, 450);
        }
        
        function credits(){
          ca.font = "40px Arial";
          ca.fillText("Blue Scorpion", 80, 150);
          ca.fillText("Kevin MacLeod (incompetech.com)", 80, 200);
          ca.fillText("Licensed under Creative Commons: By Attribution 3.0", 80, 250);
          ca.fillText("http://creativecommons.org/licenses/by/3.0/", 80, 300);
        }
        
        function keyPressed(){
            if(e.code === "ArrowLeft"){
              p1x = p1x - 20;
            }
            if(e.code === "ArrowRight"){
              p1x = p1x + 20;
            }
          }

        function loopTheme(){
          gameTheme.play();
          setTimeOut(function(){
            gameTheme.stop();
          }, 376000);
        }
        
        function preload(){
          //platform = loadImage('Media/Players/RedPlayer.jpg');
          //landscape = loadImage('Media/Players/GreenPlayer.jpg');
          //theme = loadSound('Media/Sound/sound.wav');
        }
       }

//box;
var b1x = 200;
var b1y = 300;
var bWidth = 30;
var bHeight = 70;
var b1position = 0;
var bSpeed = 2;
var bDirection = -1;

var direction = 1;
var velocity = 2;
var fallingSpeed = 2;

//multimedia
var platform;
var theme;
      
    </script>
  </body>
</html>
